extends layout.pug

block pageName
  title Dashboard

block content
  include flash.pug

  .container.mt-4
    .d-flex.justify-content-between.align-items-center
      h1 Dashboard
      button.btn.btn-primary Signout
    
  .container.card.mt-4
    .mt-3
      h2 Account Details
    .mt-2
      p #{user.displayName}
      ul
        each email in user.emails
          li= email.value
            a(href='/auth/google/logout')

  .container.mt-4
    h2 Organizations

    .row

      .col-lg.mt-3
        h4 Claim a new organization
        form(action='/claimNewOrg' method='post')
          .d-flex.justify-content-between
            .mt-2.flex-grow-1.mr-3
              .input-group
                label(for='oid')
                .input-group-prepend
                  span.input-group-text(id='prepend')= frontEnd
                input.form-control(type='text' name='oid' id='oid' aria-describedby='prepend' pattern='[A-Za-z0-9_-]{3,}')
            .mt-2.flex-grow-0
              button.btn.btn-primary(type='submit') Claim

      .col-lg.mt-3
        h4 Organizations
        if richOrgs
          ul.mt-2.list-group
            each org in richOrgs
              li.list-group-item
                .mt-1.d-flex.justify-content-between
                  .d-flex.justify-content-start
                    p.mr-2= org.id
                    a.mr-2(href=org.displayUrl)
                      i.fa.fa-external-link
                    if org.isAdmin
                      p.text-muted (admin)
                    if org.isPending
                      p.text-muted (pending)
                  .d-flex.justify-content-start
                    a.mr-2(href=org.editUrl)
                      i.fa.fa-edit
                    a(href=org.downloadUrl)
                      i.fa.fa-cloud-download
        else
          span No orgs claimed!

