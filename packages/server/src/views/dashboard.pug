extends layout.pug

block pageName
  title Dashboard

block content
  - var levels = ['success', 'warning', 'danger', 'primary']
  .container.mt-4
    each level in levels
      if flash[level]
        each msg in flash[level]
          .alert(class='alert-'+level).mt-3.mb-2= msg

  .container.mt-4
    .d-flex.justify-content-between.align-items-center
      h1 Dashboard
      button.btn.btn-primary Signout
    
  .container.card.mt-4
    .mt-3
      h2 Account Details
    .mt-2
      p #{user.displayName}
      ul
        each email in user.emails
          li= email.value
            a(href='/auth/google/logout')

  .container.mt-4
    h2 Organizations

    .row

      .col-lg.mt-3
        h4 Claim a new organization
        form(action='/claimNewOrg' method='post')
          .d-flex.justify-content-between
            .mt-2.flex-grow-1.mr-3
              .input-group
                label(for='org')
                .input-group-prepend
                  span.input-group-text(id='prepend')= frontEnd
                input.form-control(type='text' name='org' id='org' aria-describedby='prepend')
            .mt-2.flex-grow-0
              button.btn.btn-primary(type='submit') Claim

      .col-lg.mt-3
        h4 Organizations
        if richOrgs
          ul.mt-2.list-group
            each org in richOrgs
              li.list-group-item
                .mt-1.d-flex.justify-content-between
                  .d-flex.justify-content-start
                    a.mr-1(href=frontEnd + 'org/' + org.id)= frontEnd + 'org/' + org.id
                    if org.isAdmin
                      p.text-muted (admin)
                    if org.isPending
                      p.text-muted (pending)
                  a(href='/download/' + org.id)
                    i.fa.fa-cloud-download
        else
          span No orgs claimed!

